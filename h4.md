# h4 NFC ja RFID

## a) Tarkastele käytössäsi olevia RFID tuotteita, mieti miten hyvin olet suojautunut RFID urkinnalta?

Käytän päivittäin RFID ja NFC tunnisteita, kuten kulkulupana toimivaa MIFARE DESFire korttia, sekä ajoneuvon etälukutägiä parkkihalliin.
DESFire perustuu vahvaan salaukseen, joten sen luvaton kopiointi ei ole realistinen 
riski, myös auton tägi toimii rajatussa ympäristössä lyhyellä etäisyydellä. Pankkikortit on lisättynä puhelimen Wallet sovellukseen,
tämä on turvallinen tapa käyttää NFC-maksuja, koska puhelin edellyttää lukituksen avaamista ja biometrisen tunnistuksen. Pidän puhelimen NFC:n pois
päältä silloin, kun en käytä sitä. En käytä erikseen RFID suojalompakoita enkä kääri kortteja folioon,
mutta huolehdin siitä, etteivät tunnisteet ole helposti lähilukijan saatavilla. Käytössäni olevat tunnisteet perustuvat moderneihin, suojattuihin standardeihin
ja ymmärrän niiden toimintaperiaatteet ja riskit, arvioin oman suojautumiseni RFID urkintaa vastaan kokonaisuutena hyväksi ja riittäväksi.

## b) Tutustu APDU komentojen rakenteeseen (voit käyttää tekoälyä tutustumiseen)

APDU komennot ovat älykorttien ja NFC tunnisteiden “keskustelukieli”, eli tapa, jolla lukija ja kortti vaihtavat tietoa keskenään. Yksittäinen komento koostuu tietyistä osista: CLA määrittää komentoluokan,
INS kertoo mitä toimintoa pyydetään esimerkiksi SELECT, P1/P2 komennon parametreja. Jos kortille lähetetään dataa, mukana on Lc ja varsinainen Data, ja jos kortilta odotetaan vastausta, komennossa on Le,
joka määrittää palautettavan datan pituuden. Kortin vastaus sisältää mahdollisen datan sekä tilakoodit SW1 ja SW2, joista esimerkiksi 9000 tarkoittaa onnistunutta suoritusta. Olen työn kautta oppinut APDU
komentojen peruslogiikan peruslogiikan. Kun kulkulupia alustetaan, avaimia vaihdetaan tai testataan kortin ja lukijan välistä toimintaa, taustalla hyödynnetään juuri näitä komentoja.
Vianetsinnän yhteydessä on myös tullut nähtyä, miten erilaiset statuskoodit kertovat esim virheestä.


## c) Mielenkiintoinen RFID-hakkerointiuutinen

Löysin uutisen Quarkslabin tutkimuksesta, jossa paljastettiin hardware-takaportti tietyissä MIFARE Classic pohjaisissa RFID korteissa. Tutkijoiden mukaan kortteja voidaan kloonata
nopeasti pelkän fyysisen kortin perusteella, ilman että tarvitsee murtaa salauksia tai kerätä avaimia. Käytännössä tämä tarkoittaa, että hyökkääjä voi tehdä toimivan kopion muutamassa
minuutissa esimerkiksi Proxmark3-laitteella. Tämä uutinen kiinnitti huomioni, koska olen itse työskennellyt MIFARE Classic korttien parissa ja on tullut tutuksi niiden rajoitukset.
Classic-korttien Crypto1 salauson jo ennestään heikko, muttalaitteistotasoinen takaportti tekee tiettyjen sarjojen kloonauksesta vieläkin helpompaa. Uutinen korostaa hyvin sitä,
miksi Classic-teknologiaa ei pitäisi enää käyttää turvakriittisissä kohteissaja miksi siirtyminen moderneihin DESFire-tunnisteisiin on perusteltua.

# Lähteet


https://thehackernews.com/2024/08/hardware-backdoor-discovered-in-rfid.html
https://www.enigmasoftware.com/fi/varo-miljoonista-rfid-korteista-loydetty-takaoven-haavoittuvuus-mahdollistaa-valittoman-kloonauksen/
